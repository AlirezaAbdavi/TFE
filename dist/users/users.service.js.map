{"version":3,"sources":["../../src/users/users.service.ts"],"sourcesContent":["import { Injectable, NotFoundException } from '@nestjs/common';\r\nimport { InjectModel } from '@nestjs/mongoose';\r\nimport { Model } from 'mongoose';\r\nimport { User, UserDocument } from './schemas/user.schema';\r\nimport { CreateUserDto } from './dto/create-user.dto';\r\nimport { UpdateUserDto } from './dto/update-user.dto';\r\nimport * as bcrypt from 'bcrypt';\r\n\r\n@Injectable()\r\nexport class UsersService {\r\n  constructor(@InjectModel(User.name) private userModel: Model<UserDocument>) {}\r\n\r\n  async findAll() {\r\n    return this.userModel.find().exec();\r\n  }\r\n\r\n  async create(createUserDto: CreateUserDto) {\r\n    const salt = await bcrypt.genSalt();\r\n    const hashPassword = await bcrypt.hash(createUserDto.password, salt);\r\n    const userWhitHash = { ...createUserDto, password: hashPassword };\r\n\r\n    const createdUser = new this.userModel(userWhitHash);\r\n    return createdUser.save();\r\n  }\r\n\r\n  async findOne(id: string) {\r\n    const user = await this.userModel.findById(id).exec();\r\n    if (!user) throw new NotFoundException('کاربر یافت نشد');\r\n    return user;\r\n  }\r\n\r\n  async deleteOne(id: string) {\r\n    const user = await this.userModel.deleteOne({ id }).exec();\r\n    if (!user) throw new NotFoundException('کاربر یافت نشد');\r\n    return user;\r\n  }\r\n\r\n  async updateOne(updateUserDto: UpdateUserDto, id: string) {\r\n    const updatedUser = await this.userModel\r\n      .updateOne({ _id: id }, updateUserDto)\r\n      .exec();\r\n    return updatedUser;\r\n  }\r\n\r\n  async findOneByEmail(email: string): Promise<User | null> {\r\n    const user = await this.userModel.findOne({ email }).exec();\r\n    if (!user) throw new NotFoundException('کاربر یافت نشد');\r\n    return user;\r\n  }\r\n}\r\n"],"names":["UsersService","findAll","userModel","find","exec","create","createUserDto","salt","bcrypt","genSalt","hashPassword","hash","password","userWhitHash","createdUser","save","findOne","id","user","findById","NotFoundException","deleteOne","updateOne","updateUserDto","updatedUser","_id","findOneByEmail","email","name"],"mappings":";;;;+BASaA;;;eAAAA;;;wBATiC;0BAClB;2BACN;4BACa;gEAGX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGjB,IAAA,AAAMA,eAAN,MAAMA;IAGX,MAAMC,UAAU;QACd,OAAO,IAAI,CAACC,SAAS,CAACC,IAAI,GAAGC,IAAI;IACnC;IAEA,MAAMC,OAAOC,aAA4B,EAAE;QACzC,MAAMC,OAAO,MAAMC,QAAOC,OAAO;QACjC,MAAMC,eAAe,MAAMF,QAAOG,IAAI,CAACL,cAAcM,QAAQ,EAAEL;QAC/D,MAAMM,eAAe;YAAE,GAAGP,aAAa;YAAEM,UAAUF;QAAa;QAEhE,MAAMI,cAAc,IAAI,IAAI,CAACZ,SAAS,CAACW;QACvC,OAAOC,YAAYC,IAAI;IACzB;IAEA,MAAMC,QAAQC,EAAU,EAAE;QACxB,MAAMC,OAAO,MAAM,IAAI,CAAChB,SAAS,CAACiB,QAAQ,CAACF,IAAIb,IAAI;QACnD,IAAI,CAACc,MAAM,MAAM,IAAIE,yBAAiB,CAAC;QACvC,OAAOF;IACT;IAEA,MAAMG,UAAUJ,EAAU,EAAE;QAC1B,MAAMC,OAAO,MAAM,IAAI,CAAChB,SAAS,CAACmB,SAAS,CAAC;YAAEJ;QAAG,GAAGb,IAAI;QACxD,IAAI,CAACc,MAAM,MAAM,IAAIE,yBAAiB,CAAC;QACvC,OAAOF;IACT;IAEA,MAAMI,UAAUC,aAA4B,EAAEN,EAAU,EAAE;QACxD,MAAMO,cAAc,MAAM,IAAI,CAACtB,SAAS,CACrCoB,SAAS,CAAC;YAAEG,KAAKR;QAAG,GAAGM,eACvBnB,IAAI;QACP,OAAOoB;IACT;IAEA,MAAME,eAAeC,KAAa,EAAwB;QACxD,MAAMT,OAAO,MAAM,IAAI,CAAChB,SAAS,CAACc,OAAO,CAAC;YAAEW;QAAM,GAAGvB,IAAI;QACzD,IAAI,CAACc,MAAM,MAAM,IAAIE,yBAAiB,CAAC;QACvC,OAAOF;IACT;IAtCA,YAAY,AAAgChB,SAA8B,CAAE;aAAhCA,YAAAA;IAAiC;AAuC/E;;;6DAvCgC0B"}